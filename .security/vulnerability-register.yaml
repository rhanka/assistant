vulnerability_register:
  metadata:
    last_updated: 2025-08-19
    policy: All vulnerabilities must be documented with justification and timeline
    categories:
      false_positive:
        description: Vulnerability detected by the tool but not applicable in our context
        examples:
          - Test code that is never executed in production
          - Specific configuration that neutralizes the risk
          - Tool scan limitation
        
      accepted_risk:
        description: Real vulnerability but the risk is acceptable in the current context
        examples:
          - Isolated development environment
          - Risk limited by architecture
          - Temporary risk during transition
        
      planned_mitigation:
        description: Real vulnerability that will be fixed according to a defined plan
        examples:
          - Waiting for upstream fix in a dependency
          - Fix planned in next iteration
          - Mitigation in progress
        
      technical_debt:
        description: Vulnerability inherited from legacy code or previous architectures
        examples:
          - Legacy code requiring major refactoring
          - Inherited architecture being modernized
          - Obsolete dependencies being migrated
  
  findings:
    # === STRUCTURE EXAMPLE ===
    # Vulnerabilities will be added here by copying from the parsed report
    # and manually completing: category, risk, fix_goal
    
    - id: dockerfile.security.missing-user.missing-user_packages_api_Dockerfile_L27
      rule_id: dockerfile.security.missing-user.missing-user
      service: api
      file: packages/api/Dockerfile
      lines: [27]
      severity: ERROR
      cwe: [CWE-250: Execution with Unnecessary Privileges]
      owasp: [A04:2021 - Insecure Design]
      message: By not specifying a USER, a program in the container may run as 'root'
      fix: |-
        USER non-root
        CMD ["npm", "run", "test:unit"]
      context: |-
        # Test stage
        FROM base AS test
        # Tests can run here with all dependencies available
        CMD ["npm", "run", "test:unit"]
        # Production stage
        FROM node:20 AS production   
      category: planned_mitigation
      risk: Low risk in dev environment
      fix_goal: 1m
      
    - id: dockerfile.security.missing-user.missing-user_packages_api_Dockerfile_L47
      rule_id: dockerfile.security.missing-user.missing-user
      service: api
      file: packages/api/Dockerfile
      lines: [47]
      severity: ERROR
      cwe: [CWE-250: Execution with Unnecessary Privileges]
      owasp: [A04:2021 - Insecure Design]
      message: By not specifying a USER, a program in the container may run as 'root'
      fix: |-
        USER non-root
        CMD ["npm", "run", "start"]
      context: |-
        # Production stage
        FROM node:20 AS production
        # Copy built application
        COPY --from=build /app/dist ./dist
        # Expose port
        EXPOSE 3001
        # Start the application
        CMD ["npm", "run", "start"]
      category: planned_mitigation
      risk: Low (no prod yet)
      fix_goal: 1w
      
      # === METADATA ===
      accepted_date: 2025-08-19
      reviewed_by: antoinefa
      next_review: 2025-12-01
    
    - id: dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L27
      rule_id: dockerfile.security.missing-user.missing-user
      service: ui
      file: packages/ui/Dockerfile
      lines: [27]
      severity: ERROR
      cwe: [CWE-250: Execution with Unnecessary Privileges]
      owasp: [A04:2021 - Insecure Design]
      message: By not specifying a USER, a program in the container may run as 'root'
      fix: |-
        USER non-root
        CMD ["npm", "run", "test:unit"]
      context: |-
        # Test stage
        FROM base AS test
        # Tests can run here with all dependencies available
        CMD ["npm", "run", "test:unit"]
      category: planned_mitigation
      risk: Low risk in dev environment
      fix_goal: 1m
      
      # === METADATA ===
      accepted_date: 2025-08-19
      reviewed_by: antoinefa
      next_review: 2025-12-01
    
    - id: dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L44
      rule_id: dockerfile.security.missing-user.missing-user
      service: ui
      file: packages/ui/Dockerfile
      lines: [44]
      severity: ERROR
      cwe: [CWE-250: Execution with Unnecessary Privileges]
      owasp: [A04:2021 - Insecure Design]
      message: By not specifying a USER, a program in the container may run as 'root'
      fix: |-
        USER non-root
        CMD ["nginx", "-g", "daemon off;"]
      context: |-
        # Production stage
        FROM nginx:alpine AS production
        # Copy built application
        COPY --from=build /app/build /usr/share/nginx/html
        # Copy nginx configuration
        COPY packages/ui/nginx.conf /etc/nginx/nginx.conf
        # Expose port
        EXPOSE 80
        # Start nginx
        CMD ["nginx", "-g", "daemon off;"]
      category: planned_mitigation
      risk: Low risk in production environment
      fix_goal: 1w
      
      # === METADATA ===
      accepted_date: 2025-08-19
      reviewed_by: antoinefa
      next_review: 2025-12-01
    
    - id: dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L49
      rule_id: dockerfile.security.missing-user.missing-user
      service: ui
      file: packages/ui/Dockerfile
      lines: [49]
      severity: ERROR
      cwe: [CWE-250: Execution with Unnecessary Privileges]
      owasp: [A04:2021 - Insecure Design]
      message: By not specifying a USER, a program in the container may run as 'root'
      fix: |-
        USER non-root
        CMD ["npm", "run", "dev"]
      context: |-
        # Development stage
        FROM base AS dev
        # Development mode with hot reload
        CMD ["npm", "run", "dev"]
      category: planned_mitigation
      risk: Low risk in dev environment
      fix_goal: 1m
      
      # === METADATA ===
      accepted_date: 2025-08-19
      reviewed_by: antoinefa
      next_review: 2025-12-01
