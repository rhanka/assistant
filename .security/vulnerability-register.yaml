vulnerability_register:
  metadata:
    last_updated: 2025-08-20
    policy: All vulnerabilities must be documented with justification and timeline
    note: Migrated from node:20 (Debian) to node:24-alpine3.22 to eliminate base image vulnerabilities
    categories:
      false_positive:
        description: Vulnerability detected by the tool but not applicable in our context
        examples:
          - Test code that is never executed in production
          - Specific configuration that neutralizes the risk
          - Tool scan limitation
      accepted_risk:
        description: Vulnerability acknowledged but risk is acceptable in current context
        examples:
          - Development environment only
          - Isolated container environment
          - Compensating controls in place
      planned_mitigation:
        description: Vulnerability will be addressed in planned timeframe
        examples:
          - Dockerfile hardening (non-root users)
          - Dependency updates
          - Configuration improvements
      technical_debt:
        description: Technical debt that will be addressed during refactoring
        examples:
          - Legacy code patterns
          - Architecture improvements
          - Security framework upgrades

  vulnerabilities:
    # Dockerfile security - missing non-root users
    dockerfile.security.missing-user.missing-user_packages_workers_Dockerfile_L25:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for test stage
      file: packages/workers/Dockerfile
      line: 25
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_workers_Dockerfile_L41:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for production stage
      file: packages/workers/Dockerfile
      line: 41
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_workers_Dockerfile_L46:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for default stage
      file: packages/workers/Dockerfile
      line: 46
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    # Dockerfile security - missing non-root users (API)
    dockerfile.security.missing-user.missing-user_packages_api_Dockerfile_L27:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for test stage
      file: packages/api/Dockerfile
      line: 27
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_api_Dockerfile_L47:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for production stage
      file: packages/api/Dockerfile
      line: 47
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    # Dockerfile security - missing non-root users (Scheduler)
    dockerfile.security.missing-user.missing-user_packages_scheduler_Dockerfile_L25:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for test stage
      file: packages/scheduler/Dockerfile
      line: 25
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_scheduler_Dockerfile_L41:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for production stage
      file: packages/scheduler/Dockerfile
      line: 41
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_scheduler_Dockerfile_L46:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for default stage
      file: packages/scheduler/Dockerfile
      line: 46
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    # Dockerfile security - missing non-root users (UI)
    dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L26:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for test stage
      file: packages/ui/Dockerfile
      line: 26
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L37:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for production stage
      file: packages/ui/Dockerfile
      line: 37
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open

    dockerfile.security.missing-user.missing-user_packages_ui_Dockerfile_L42:
      category: planned_mitigation
      risk: MEDIUM
      description: Dockerfile missing USER directive for development stage
      file: packages/ui/Dockerfile
      line: 42
      cwe: CWE-250
      owasp: A04:2021
      fix_goal: 1w
      justification: Will add non-root user in Dockerfile hardening phase
      status: open
